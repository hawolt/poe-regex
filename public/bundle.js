!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var o in n)("object"==typeof exports?exports:e)[o]=n[o]}}(self,(()=>(()=>{"use strict";var e;class t{constructor(e,t){this.mod=e,this.t17=t}getModifier(){return this.mod}isT17(){return this.t17}equals(e){return this===e||!!e&&this.mod===e.getModifier()&&this.t17===e.isT17()}}function n(e,t){let n=[],o=e.getModifier().toLowerCase();for(let e=0;e<o.length;e++)for(let s=e+1;s<=o.length;s++){let i=o.substring(e,s);1!=i.length&&(t.blacklisted(i)||n.push(i))}return n.sort(((e,t)=>e.length-t.length)),n}!function(e){e[e.INCLUSIVE=0]="INCLUSIVE",e[e.EXCLUSIVE=1]="EXCLUSIVE"}(e||(e={}));class o{constructor(e,t,n){this.modifiers=t,this.blacklist=n,this.t17=e}includes(e,t){for(const n of t)if(n.equals(e))return!0;return!1}unique(e,t,n){for(let o=0;o<this.modifiers.length;o++){let s=this.modifiers[o];if(s.getModifier().toLowerCase().includes(e)){if(s.isT17()&&!this.t17)continue;let e=!1;for(const t of n)s.getModifier().toLowerCase().includes(t)&&(e=!0);if(e)continue;if(!this.includes(s,t))return!1}}return!0}create(e,t,o){if(0===o.length)return;o=e.upgrade(this.t17,o,t);let s=new Set;for(let e=0;e<o.length;e++)n(o[e],this.blacklist).forEach((e=>s.add(e)));const i=new Map;let r=2;for(;o.length>0;){const e=r,n=Array.from(s).filter((t=>t.length===e));if(0===n.length&&i.size>0)break;for(const e of n){if(e.length>=20)break;if(this.unique(e,o,t))for(const t of o)t.getModifier().toLowerCase().includes(e.toLowerCase())&&(i.has(e)||i.set(e,0),i.set(e,(i.get(e)||0)+1))}r+=1}let l=Array.from(i.entries());l.sort(((e,t)=>{const n=t[1]-e[1];return 0!==n?n:e[0].length+(e[0].includes("#")?2:0)-(t[0].length+(t[0].includes("#")?2:0))}));const c=l[0][0];o=o.filter((e=>!e.getModifier().toLowerCase().includes(c))),t.add(c),this.create(e,t,o)}}class s{constructor(){this.blacklist=new Set}populate(e){for(let t=0;t<e.length;t++)this.blacklist.add(e[t].toLowerCase())}blacklisted(e){for(let t of this.blacklist)if(t.includes(e))return!0;return!1}}class i{constructor(e){this.array=[[90,[91]],[91,[90]],[18,[60]],[60,[18]],[49,[50,27]],[50,[49,27]],[27,[49,50]],[61,[64,25]],[64,[61,25]],[25,[61,64]],[66,[14]],[14,[66]],[72,[74,75,33]],[74,[72,75,33]],[75,[72,74,33]],[33,[72,74,75]],[86,[92,2]],[92,[86,2]],[2,[86,92]],[102,[21]],[21,[102]],[103,[22]],[22,[103]],[125,[1]],[1,[125]]],this.mapping=new Map;let n=new Map;for(let o=0;o<this.array.length;o++){let s=this.array[o][0],i=e[s],r=new t(i.getModifier(),i.isT17());n.set(s,r)}for(let e=0;e<this.array.length;e++){let t=this.array[e],o=t[0],s=t[1],i=n.get(o),r=[];for(let e=0;e<s.length;e++){let t=s[e],o=n.get(t);o&&r.push(o)}i&&r&&this.mapping.set(i,r)}}upgrade(e,t,n){const o=new Set(t),s=Array.from(this.mapping.keys());for(const i of t)for(const t of s)if(i.equals(t)){let s=this.mapping.get(t)||[];for(const i of s)if(e||i.isT17()||i.getModifier().includes("#% more Monster Life")){let e=!1;for(const t of n)if(i.getModifier().toLowerCase().includes(t)){e=!0;break}e||(console.log("+ "+t.getModifier()),console.log("> "+i.getModifier()),console.log("---"),o.add(i))}}return Array.from(o)}}function r(e,t,n){let o=parseFloat(e);if(isNaN(o))return null;if(t&&(o=10*Math.floor(o/10)),0===o)return null;let s=Math.floor(o%100/10),i=o%10;return o>=200?n?"2..":"[2-9]\\d{2}":199===o?"199":o>100?0==i?`1[${s}-9].`:0===s?`(\\d0[${i}-9]|\\d[1-9].)`:9===s?8!=i?`19[${s}-9]`:"19[89]":n?`1([${s}-9][${i}-9]|[${s+1}-9].)`:`\\d([${s}-9][${i}-9]|[${s+1}-9].)`:100===o?"d{3}":o>=10?0===i?`([${s}-9].|1..)`:9===s?`(${s}[${i}-9]|1..)`:`(${s}[${i}-9]|[${s+1}-9].|1..)`:o<10?9===o?"(9|\\d..?)":8===o?"([89]|\\d..?)":o>1?`([${o}-9]|\\d..?)`:"":e}const l=performance.now();let c=new s,a=[],d=[],f=[];function u(){const e=document.getElementById("t17");let t=new o(e.checked,a,c),n="";if(d.length>0){let e=new Set,o=new i(a);try{t.create(o,e,d),n=Array.from(e).join("|").replace(/#/g,"\\d+"),n=`"!${n}"`}catch(e){console.error(e)}}let s=r(document.getElementById("quantity").value,document.getElementById("optimize-quantity").checked,!0),l=r(document.getElementById("pack-size").value,document.getElementById("optimize-pack").checked,!0);s&&(n+=' "m q.*'+s+'%"'),l&&(n+=' "iz.*'+l+'%"'),document.getElementById("regex").innerText=n,document.getElementById("hint").innerText=n.length>0?`length: ${n.length} / 50`:"",h(!1)}function h(e){const t=document.getElementById("overlay"),n=document.getElementById("modal"),o=document.body;t.classList.toggle("hidden",!e),n.classList.toggle("hidden",!e),o.classList.toggle("no-scroll",e)}async function g(e){const t=e.map((e=>fetch(e).then((t=>{if(!t.ok)throw new Error(`Failed to load ${e}: ${t.status} ${t.statusText}`);return t.text()}))));return Promise.all(t)}function m(t,n){const o=document.createElement("div");return o.classList.add("selectable"),n.isT17()&&(o.classList.add("t17"),o.style.display="none"),o.dataset.t17=n.isT17().toString(),o.textContent=n.getModifier(),o.addEventListener("click",(o=>{let s=o.target;s.classList.toggle("selected-item");let i=s.classList.contains("selected-item"),r=t==e.EXCLUSIVE?d:f;if(i)r.push(n);else{const e=r.indexOf(n);e>-1&&r.splice(e,1)}})),o}function p(e){var t;const n=e.value,o=null===(t=e.closest(".container-search"))||void 0===t?void 0:t.nextElementSibling,s=document.getElementById("t17");if(o&&o.classList.contains("mod-container")){let e=o.children;for(let t=0;t<e.length;t++){const o=e[t];o.textContent&&o.textContent.toLowerCase().includes(n.toLowerCase())?(s.checked&&"true"===o.dataset.t17||"false"===o.dataset.t17)&&(o.style.display=""):o.style.display="none"}}}return document.addEventListener("DOMContentLoaded",(()=>{g(["./league/settler/map.name.config","./league/settler/map.affix.config","./league/settler/map.general.config"]).then((e=>function(e){const t=new s;for(let n=0;n<e.length;n++){let o=e[n].split("\n");t.populate(o)}return t}(e))).then((n=>{c=n,async function(){g(["./league/settler/map.mods.config"]).then((e=>e[0])).then((n=>function(n){let o=n.split("\n"),s=document.querySelectorAll(".mod-container");for(let n=0;n<o.length;n++){let i=o[n].trim(),r=i.indexOf("(T17)");-1!=r&&(i=i.substring(6));const l=new t(i,-1!=r);a.push(l);for(let t=0;t<s.length;t++){let n=0==t?e.EXCLUSIVE:e.INCLUSIVE;s[t].appendChild(m(n,l))}}}(n)))}().then((()=>function(){document.querySelectorAll(".container-search").forEach((e=>{e.addEventListener("input",(e=>{p(e.target)}))})),document.getElementById("t17").addEventListener("change",(e=>{const t=e.target;document.querySelectorAll('[data-t17="true"]').forEach((e=>{let n=e;n.style.display=t.checked?"block":"none",t.checked||n.classList.remove("selected-item")})),document.querySelectorAll(".container-search").forEach((e=>{p(e)}))})),document.getElementById("generate").addEventListener("click",(()=>{document.getElementById("regex").innerText="",document.getElementById("hint").innerText="",setTimeout(u,100),h(!0)}));const e=document.querySelectorAll('input[type="checkbox"]');e.forEach((t=>{t.addEventListener("change",(()=>{!function(t){const n=t.classList;let o="";for(const e of n)if(e.includes("btn-group-")){o=e;break}if(0!=o.length)if(t.checked)e.forEach((e=>{e.classList.contains(o)&&e!=e&&(e.checked=!1)}));else{const n=Array.from(e).filter((e=>e.classList.contains(o))),s=n.some((e=>e.checked));s||(t.checked=!0)}}(t)}))}))}())).then((()=>function(){const e=performance.now()-l;console.log(`build-time ${e}ms`)}()))})).catch((e=>function(e){console.error(e)}(e)))})),{}})()));