!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(self,(()=>(()=>{"use strict";var e;class t{constructor(e,t){this.mod=e,this.t17=t}getModifier(){return this.mod}isT17(){return this.t17}equals(e){return this===e||!!e&&this.mod===e.getModifier()&&this.t17===e.isT17()}}function n(e,t){let n=[],r=e.getModifier().toLowerCase();for(let e=0;e<r.length;e++)for(let o=e+1;o<=r.length;o++){let l=r.substring(e,o);1!=l.length&&(t.blacklisted(l)||n.push(l))}return n.sort(((e,t)=>e.length-t.length)),n}!function(e){e[e.INCLUSIVE=0]="INCLUSIVE",e[e.EXCLUSIVE=1]="EXCLUSIVE"}(e||(e={}));class r{constructor(e,t,n){this.modifiers=t,this.blacklist=n,this.t17=e}includes(e,t){for(const n of t)if(n.equals(e))return!0;return!1}unique(e,t,n){for(let r=0;r<this.modifiers.length;r++){let o=this.modifiers[r];if(o.getModifier().toLowerCase().includes(e)){if(o.isT17()&&!this.t17)continue;let e=!1;for(const t of n)o.getModifier().toLowerCase().includes(t)&&(e=!0);if(e)continue;if(!this.includes(o,t))return!1}}return!0}create(e,t,r){if(0===r.length)return;r=e.upgrade(this.t17,r,t);let o=new Set;for(let e=0;e<r.length;e++)n(r[e],this.blacklist).forEach((e=>o.add(e)));const l=new Map;let i=2;for(;r.length>0;){const e=i,n=Array.from(o).filter((t=>t.length===e));if(0===n.length&&l.size>0)break;for(const e of n){if(e.length>=20)break;if(this.unique(e,r,t))for(const t of r)t.getModifier().toLowerCase().includes(e.toLowerCase())&&(l.has(e)||l.set(e,0),l.set(e,(l.get(e)||0)+1))}i+=1}let s=Array.from(l.entries());s.sort(((e,t)=>{const n=t[1]-e[1];return 0!==n?n:e[0].length+(e[0].includes("#")?2:0)-(t[0].length+(t[0].includes("#")?2:0))}));const c=s[0][0];r=r.filter((e=>!e.getModifier().toLowerCase().includes(c))),t.add(c),this.create(e,t,r)}}class o{constructor(){this.blacklist=new Set}populate(e){for(let t=0;t<e.length;t++)this.blacklist.add(e[t].toLowerCase())}blacklisted(e){for(let t of this.blacklist)if(t.includes(e))return!0;return!1}}class l{constructor(e){this.array=[[90,[91]],[91,[90]],[18,[60]],[60,[18]],[49,[50,27]],[50,[49,27]],[27,[49,50]],[61,[64,25]],[64,[61,25]],[25,[61,64]],[66,[14]],[14,[66]],[72,[74,75,33]],[74,[72,75,33]],[75,[72,74,33]],[33,[72,74,75]],[86,[92,2]],[92,[86,2]],[2,[86,92]],[102,[21]],[21,[102]],[103,[22]],[22,[103]],[125,[1]],[1,[125]]],this.mapping=new Map;let n=new Map;for(let r=0;r<this.array.length;r++){let o=this.array[r][0],l=e[o],i=new t(l.getModifier(),l.isT17());n.set(o,i)}for(let e=0;e<this.array.length;e++){let t=this.array[e],r=t[0],o=t[1],l=n.get(r),i=[];for(let e=0;e<o.length;e++){let t=o[e],r=n.get(t);r&&i.push(r)}l&&i&&this.mapping.set(l,i)}}upgrade(e,t,n){const r=new Set(t),o=Array.from(this.mapping.keys());for(const l of t)for(const t of o)if(l.equals(t)){let o=this.mapping.get(t)||[];for(const l of o)if(e||l.isT17()||l.getModifier().includes("#% more Monster Life")){let e=!1;for(const t of n)if(l.getModifier().toLowerCase().includes(t)){e=!0;break}e||(console.log("+ "+t.getModifier()),console.log("> "+l.getModifier()),console.log("---"),r.add(l))}}return Array.from(r)}}function i(e,t,n){let r=parseFloat(e);if(isNaN(r))return null;if(t&&(r=10*Math.floor(r/10)),0===r)return null;let o=Math.floor(r%100/10),l=r%10;if(r>=200)return"2..";if(199===r)return"199";if(r>100)return 0==l?`1[${o}-9].`:0===o?`(\\d0[${l}-9]|\\d[1-9].)`:9===o?8!=l?`19[${o}-9]`:"19[89]":`1([${o}-9][${l}-9]|[${o+1}-9].)`;if(100===r)return"\\d{3}";if(r>=10){if(0===l){let e;return e=9===o?"9.":8===o?"[89].":`[${o}-9].`,n?`(${e}|1..)`:e}return 9===o?n?`(${o}[${l}-9]|1..)`:`(${o}[${l}-9])`:n?`(${o}[${l}-9]|[${o+1}-9].|1..)`:`(${o}[${l}-9]|[${o+1}-9].)`}return r<10?9===r?"(9|\\d..?)":8===r?"([89]|\\d..?)":r>1?`([${r}-9]|\\d..?)`:"":e}const s=performance.now();let c=new Map,a=new Map,d=new o,u=[],f=[],g=[];function h(e){const t=document.getElementById("overlay"),n=document.getElementById("modal"),r=document.body;t.classList.toggle("hidden",!e),n.classList.toggle("hidden",!e),r.classList.toggle("no-scroll",e)}async function m(e){const t=e.map((e=>fetch(e).then((t=>{if(!t.ok)throw new Error(`Failed to load ${e}: ${t.status} ${t.statusText}`);return t.text()}))));return Promise.all(t)}function p(t,n){const r=document.createElement("div");return r.classList.add("selectable"),n.isT17()&&(r.classList.add("t17"),r.style.display="none"),r.dataset.t17=n.isT17().toString(),r.textContent=n.getModifier(),r.addEventListener("click",(r=>{let o=r.target;o.classList.toggle("selected-item");let l=o.classList.contains("selected-item"),i=t==e.EXCLUSIVE?f:g;if(l)i.push(n);else{const e=i.indexOf(n);e>-1&&i.splice(e,1)}y()})),r}function E(e){var t;const n=e.value,r=null===(t=e.closest(".container-search"))||void 0===t?void 0:t.nextElementSibling,o=document.getElementById("t17");if(r&&r.classList.contains("mod-container")){let e=r.children;for(let t=0;t<e.length;t++){const r=e[t];r.textContent&&r.textContent.toLowerCase().includes(n.toLowerCase())?(o.checked&&"true"===r.dataset.t17||"false"===r.dataset.t17)&&(r.style.display=""):r.style.display="none"}}}function y(){document.getElementById("regex").innerText="crunching numbers...",document.getElementById("hint").innerText="",setTimeout((()=>{let t=document.getElementById("any").checked,n=L(!0,e.EXCLUSIVE),r=L(t,e.INCLUSIVE),o=function(){let e=i(document.getElementById("quantity").value,document.getElementById("optimize-quantity").checked,!0),t=i(document.getElementById("pack-size").value,document.getElementById("optimize-pack").checked,!1),n=i(document.getElementById("scarabs").value,document.getElementById("optimize-scarab").checked,!0),r=i(document.getElementById("maps").value,document.getElementById("optimize-maps").checked,!0),o="";return e&&(o+='"m q.*'+e+'%" '),t&&(o+='"iz.*'+t+'%" '),n&&(o+='"abs.*'+n+'%" '),r&&(o+='"ps: '+r+'%" '),o}(),l=function(){let t=document.getElementById("maps-include").checked?e.INCLUSIVE:e.EXCLUSIVE,n=[];document.getElementById("map-normal").checked&&n.push("n"),document.getElementById("map-rare").checked&&n.push("r"),document.getElementById("map-magic").checked&&n.push("m");let r=t==e.INCLUSIVE&&3!=n.length&&0!=n.length,o=t==e.EXCLUSIVE&&0!=n.length;return r||o?` "${t==e.EXCLUSIVE?"!":""}y: ${function(e){return 1==e.length?e[0]:`(${e.join("|")})`}(n)}"`:""}(),s=(n+(n.length>0?" ":"")+r+(r.length>0?" ":"")+o+l).trim();document.getElementById("regex").innerText=s;let c=document.getElementById("hint");c.innerText=s.length>0?`length: ${s.length} / 50`:"",c.style.color=s.length>50?"#ff4d4d":"#e0e0e0",h(!1)}),100)}function L(t,n){const o=document.getElementById("t17");let i=new r(o.checked,u,d),s=n==e.EXCLUSIVE?f:g,h="";if(function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(c.get(n)||[],s))h=a.get(n)||"";else{let r=new Set,o=new l(u);try{if(i.create(o,r,s),c.set(n,[...s]),t)h=Array.from(r).join("|").replace(/#/g,"\\d+"),h=h.length>0?`"${n==e.EXCLUSIVE?"!":""}${h}"`:"";else{let e="";for(const t of r)e+=t.includes(" ")?`"${t}" `:`${t} `;h=e}a.set(n,h)}catch(e){console.error(e)}}return h}function I(e){return e.filter((e=>!e.getModifier().includes("Corrupted")))}return document.addEventListener("DOMContentLoaded",(()=>{m(["./league/settler/map.name.config","./league/settler/map.affix.config","./league/settler/map.general.config","./league/settler/map.blacklist.config"]).then((e=>function(e){const t=new o;for(let n=0;n<e.length;n++){let r=e[n].split("\n");t.populate(r)}return t}(e))).then((n=>{d=n,async function(){m(["./league/settler/map.mods.config"]).then((e=>e[0])).then((n=>function(n){let r=n.split("\n"),o=document.querySelectorAll(".mod-container");for(let n=0;n<r.length;n++){let l=r[n].trim(),i=l.indexOf("(T17)");-1!=i&&(l=l.substring(6));const s=new t(l,-1!=i);u.push(s);for(let t=0;t<o.length;t++){let n=0==t?e.EXCLUSIVE:e.INCLUSIVE;o[t].appendChild(p(n,s))}}}(n)))}().then((()=>function(){document.querySelectorAll(".container-search").forEach((e=>{e.addEventListener("input",(e=>{E(e.target)}))})),document.getElementById("t17").addEventListener("change",(e=>{const t=e.target;document.querySelectorAll('[data-t17="true"]').forEach((e=>{let n=e;n.style.display=t.checked?"block":"none",t.checked||n.classList.remove("selected-item")})),document.querySelectorAll(".container-search").forEach((e=>{E(e)}))})),document.getElementById("generate").addEventListener("click",(()=>{c.clear(),h(!0),y()})),document.querySelectorAll(".trigger-0").forEach((e=>{e.addEventListener("change",(e=>{y()}))})),document.querySelectorAll(".trigger-1").forEach((e=>{e.addEventListener("input",(e=>{y()}))})),document.querySelectorAll(".trigger-2").forEach((t=>{t.addEventListener("input",(t=>{c.delete(e.INCLUSIVE)}))})),document.querySelectorAll(".trigger-3").forEach((n=>{n.addEventListener("input",(n=>{f=I(f),g=I(g);let r=null;switch(n.target.id){case"corrupted-include":r=e.INCLUSIVE;break;case"corrupted-exclude":r=e.EXCLUSIVE}if(null!=r){let n=new t("Corrupted",!1);(r===e.EXCLUSIVE?f:g).push(n)}y()}))}));const n=document.querySelectorAll('input[type="checkbox"]');n.forEach((e=>{e.addEventListener("change",(()=>{!function(e){const t=e.classList;let r="";for(const e of t)if(e.includes("btn-group-")){r=e;break}0!=r.length&&(e.checked?n.forEach((t=>{t.classList.contains(r)&&t!==e&&(t.checked=!1)})):Array.from(n).filter((e=>e.classList.contains(r))).some((e=>e.checked))||(e.checked=!0))}(e)}))}))}())).then((()=>function(){const e=performance.now()-s;console.log(`build-time ${e}ms`)}()))})).catch((e=>function(e){console.error(e)}(e)))})),{}})()));